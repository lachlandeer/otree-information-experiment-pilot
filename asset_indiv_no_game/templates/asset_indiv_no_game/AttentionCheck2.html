{% extends "global/Page.html" %}
{% block title %}
    Attention Check - Second Attempt
{% endblock %}

{% block content %}

<div class="alert alert-warning mb-4">
    <h5>Your Previous Attempt</h5>
    <p>You answered the following questions incorrectly in your first attempt:</p>
    <div class="previous-answers">
        {% if not previous_answers.q1_correct %}
        <div class="question-result text-danger">
            Question 1 ❌
        </div>
        {% endif %}
        {% if not previous_answers.q2_correct %}
        <div class="question-result text-danger">
            Question 2 ❌
        </div>
        {% endif %}
        {% if not previous_answers.q3_correct %}
        <div class="question-result text-danger">
            Question 3 ❌
        </div>
        {% endif %}
    </div>
    <p class="mt-3">Please try these questions again. Click the hint button below each question if you need help.</p>
</div>

<!-- Question 1 -->
<div class="form-group {% if not previous_answers.q1_correct %}needs-attention{% endif %}">
    {{ formfield 'question_1' }}
    {% if not previous_answers.q1_correct %}
    <div class="hint-container">
        <button class="btn btn-outline-info btn-sm show-hint-btn" type="button">Show Hint</button>
        <div class="hint-box" style="display: none;">
            <i class="fas fa-lightbulb"></i>
            <span class="hint-text">You can expect to earn more by forming an estimate that is closer to the Target value. Your Target Value depends on the value of the asset (V).</span>
        </div>
    </div>
    {% endif %}
</div>

<!-- Question 2 -->
<div class="form-group {% if not previous_answers.q2_correct %}needs-attention{% endif %}">
    {{ formfield 'question_2' }}
    {% if not previous_answers.q2_correct %}
    <div class="hint-container">
        <button class="btn btn-outline-info btn-sm show-hint-btn" type="button">Show Hint</button>
        <div class="hint-box" style="display: none;">
            <i class="fas fa-lightbulb"></i>
            <span class="hint-text">Values closer to this Mean Value, 100, are more likely to be selected as V than those further away from 100.</span>
        </div>
    </div>
    {% endif %}
</div>

<!-- Question 3 -->
<div class="form-group {% if not previous_answers.q3_correct %}needs-attention{% endif %}">
    {{ formfield 'question_3' }}
    {% if not previous_answers.q3_correct %}
    <div class="hint-container">
        <button class="btn btn-outline-info btn-sm show-hint-btn" type="button">Show Hint</button>
        <div class="hint-box" style="display: none;">
            <i class="fas fa-lightbulb"></i>
            <span class="hint-text">V is the average of all potential signals. Values closer to V are more likely to be selected as a signal than those further away from V.</span>
        </div>
    </div>
    {% endif %}
</div>

{% next_button %}

<style>
    .form-group {
        margin-bottom: 2rem;
        padding: 1rem;
        border-radius: 4px;
    }
    .needs-attention {
        border-left: 3px solid #dc3545;
        padding-left: 1rem;
        background-color: #fff8f8;
    }
    .hint-container {
        margin-top: 10px;
    }
    .hint-box {
        margin-top: 10px;
        padding: 10px;
        background-color: #f8f9fa;
        border-left: 3px solid #007bff;
        border-radius: 4px;
        transition: all 0.3s ease;
    }
    .previous-answers {
        margin: 10px 0;
        padding: 10px;
        background-color: rgba(255,255,255,0.5);
        border-radius: 4px;
    }
    .question-result {
        margin: 5px 0;
        font-size: 16px;
    }
    .result-icon {
        font-size: 20px;
        font-weight: bold;
    }
    .fas {
        margin-right: 8px;
        color: #007bff;
    }
    .alert-warning {
        background-color: #fff3cd;
        border-color: #ffeeba;
    }
    .show-hint-btn {
        font-size: 0.9rem;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Individual hint buttons
        document.querySelectorAll('.show-hint-btn').forEach(button => {
            button.addEventListener('click', function() {
                // Show the hint box
                const hintBox = this.nextElementSibling;
                hintBox.style.display = 'block';
                // Hide the button
                this.style.display = 'none';
            });
        });

        // Show hints on answer change
        document.querySelectorAll('.needs-attention input[type="radio"], .needs-attention select').forEach(input => {
            input.addEventListener('change', function() {
                const formGroup = this.closest('.form-group');
                const hintBox = formGroup.querySelector('.hint-box');
                const hintBtn = formGroup.querySelector('.show-hint-btn');
                if (hintBox && hintBtn) {
                    hintBox.style.display = 'block';
                    hintBtn.style.display = 'none';
                }
            });
        });
    });
</script>

{% endblock %}